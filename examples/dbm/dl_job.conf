# !!!!!!!!!!!!!!configuration for updater momentum & batchsize & weight initialize (zero mean 0.1 derivation)!!!!!!!!!!!!!!!!!!!!!!
cluster {
  nworker_groups: 1
  nserver_groups: 1
  workspace: "/data/zhaojing/checkpoint/autoencoder/"
}
model {
  name: "deep-big-simple-mlp"
  train_steps: 12200
  test_steps:100
  test_frequency:100
  display_frequency:10
  checkpoint_after: 1000
  checkpoint_frequency: 1000
  checkpoint: "/data/zhaojing/checkpoint/rbm0/checkpoint/step30200-worker0.bin"
  checkpoint: "/data/zhaojing/checkpoint/rbm1/checkpoint/tep30000-worker0.bin"
  checkpoint: "/data/zhaojing/checkpoint/rbm2/checkpoint/step30000-worker0.bin"
  checkpoint: "/data/zhaojing/checkpoint/rbm3/checkpoint/tep30000-worker0.bin"
  alg: kBackPropagation
  updater{
    base_lr: 0.1
    lr_change: kFixed
    type: kAdaGrad
  }

  neuralnet {
  layer {
    name: "data"
    type: kShardData
    sharddata_conf {
      path: "/data/zhaojing/mnist_train_shard"
      batchsize: 1000
    }
    exclude: kTest
  }

  layer {
    name: "data"
    type: kShardData
    sharddata_conf {
      path: "/data/zhaojing/mnist_test_shard"
      batchsize: 1000
    }
    exclude: kTrain
  }

  layer{
    name:"mnist"
    type: kMnist
    srclayers: "data"
    mnist_conf {
      norm_a: 255
      norm_b: 0
    }
  }

  layer{
    name: "fc1"
    type: kInnerProduct
    srclayers:"mnist"
    innerproduct_conf{
      num_output: 2000
    }
    param{
      name: "w1"
      init_method: kUniform
      low:-0.05
      high:0.05
    }
    param{
      name: "rb12"
      init_method: kUniform
      low: -0.05
      high:0.05
    }
  }

  layer{
    name: "sigmoid1"
    type: kSigmoid
    srclayers:"fc1"
  }
  layer{
    name: "fc2"
    type: kInnerProduct
    srclayers:"sigmoid1"
    innerproduct_conf{
      num_output: 1000
    }
    param{
      name: "w2"
      init_method: kUniform
      low:-0.05
      high:0.05
    }
    param{
      name: "rb22"
      init_method: kUniform
      low: -0.05
      high:0.05
    }
  }

  layer{
    name: "sigmoid2"
    type: kSigmoid
    srclayers:"fc2"
  }
  layer{
    name: "fc3"
    type:  kInnerProduct
    srclayers:"sigmoid2"
    innerproduct_conf{
      num_output: 500
    }
    param{
      name: "w3"
      init_method: kUniform
      low:-0.05
      high:0.05
      vis: true
    }
    param{
      name: "rb32"
      init_method: kUniform
      low: -0.05
      high:0.05
    }
  }

  layer{
    name: "sigmoid3"
    type: kSigmoid
    srclayers:"fc3"
  }
  layer{
    name: "fc4"
    type: kInnerProduct
    srclayers:"sigmoid3"
    innerproduct_conf{
      num_output: 30
    }
    param{
      name: "w4"
      init_method: kUniform
      low:-0.05
      high:0.05
      vis: true
    }
    param{
      name: "rb42"
      init_method: kUniform
      low: -0.05
      high:0.05
    }

  }

  layer{
    name: "fc5"
    type: kInnerProduct
    srclayers:"fc4"
    innerproduct_conf{
      num_output: 500
      transpose: true
    }
    param{
      name: "w5"
      share_from: "w4"
    }
    param{
      name: "rb41"
      init_method: kUniform
      low: -0.05
      high:0.05
    }

  }

  layer{
    name: "sigmoid5"
    type: kSigmoid
    srclayers:"fc5"
  }
  layer{
    name: "fc6"
    type: kInnerProduct
    srclayers:"sigmoid5"
    innerproduct_conf{
      num_output: 1000
      transpose: true
    }
    param{
      name: "w6"
      share_from: "w3"
    }
    param{
      name: "rb31"
      init_method: kUniform
      low: -0.05
      high:0.05
    }

  }

  layer{
    name: "sigmoid6"
    type: kSigmoid
    srclayers:"fc6"
  }
 layer{
    name: "fc7"
    type: kInnerProduct
    srclayers:"sigmoid6"
    innerproduct_conf{
      num_output: 2000
      transpose: true
    }
    param{
      name: "w7"
      share_from: "w2"
    }
    param{
      name: "rb21"
      init_method: kUniform
      low: -0.05
      high:0.05
    }

  }

  layer{
    name: "sigmoid7"
    type: kSigmoid
    srclayers:"fc7"
  }
 layer{
    name: "fc8"
    type: kInnerProduct
    srclayers:"sigmoid7"
    innerproduct_conf{
      num_output: 784
      transpose: true
    }
    param{
      name: "w8"
      share_from: "w1"
    }
    param{
      name: "rb11"
      init_method: kUniform
      low: -0.05
      high:0.05
    }

  }

  layer{
    name: "sigmoid8"
    type: kSigmoid
    srclayers:"fc8"
  }

  layer{
    name: "loss"
    type:kReconstructLoss
    srclayers:"sigmoid8"
    srclayers:"mnist"
  }
}
  vis_samples: 2000
  vis_frequency: 1000
  vis_after: 1000
}
